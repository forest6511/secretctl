---
title: 監査ログ
description: セキュリティコンプライアンスのための監査ログの表示、フィルタリング、エクスポート。
sidebar_position: 4
---

# 監査ログ

監査ログビューアは、すべての Vault アクティビティを確認するためのビジュアルインターフェースを提供します。すべてのアクションは改ざん検出可能な暗号化チェーンで記録されます。

## 前提条件

- [デスクトップアプリがインストール済み](/docs/guides/desktop/)
- Vault がアンロック済み

## 監査ログへのアクセス

### 監査ログを開く

1. ヘッダーバーの**クリップボードアイコン**をクリック
2. またはシークレットページからナビゲート

監査ログページにはフィルタリングオプション付きでアクティビティ履歴が表示されます。

## インターフェースの理解

### ヘッダーセクション

ヘッダーには以下が表示されます:

- **戻るボタン** - シークレットページに戻る
- **チェーンを検証** - 監査ログの整合性をチェック
- **エクスポートボタン** - CSV または JSON でダウンロード
- **チェーン状態** - 現在の検証結果
- **統計** - 合計、成功、失敗のカウント

### フィルターバー

利用可能なフィルター:

| フィルター | オプション | 用途 |
|-----------|----------|------|
| アクション | All, Get, Set, Delete, List, Unlock, Lock, Init | 操作タイプでフィルタリング |
| ソース | All, CLI, MCP, Desktop | アクセス方法でフィルタリング |
| キー | テキスト入力 | シークレットキーで検索 |
| 日付範囲 | 開始日と終了日 | 期間でフィルタリング |

### ログテーブル

各行には以下が表示されます:

| カラム | 説明 |
|--------|------|
| タイムスタンプ | アクションが発生した時刻 |
| アクション | 実行された操作 |
| ソース | Vault へのアクセス方法 |
| キー | 影響を受けたシークレット（該当する場合） |
| ステータス | 成功または失敗のインジケーター |

## ログのフィルタリング

### アクションタイプ別

特定の操作を表示するためにフィルタリング:

1. **アクション**ドロップダウンをクリック
2. アクションタイプを選択
3. **適用**をクリック

**アクションタイプ:**

| アクション | 説明 |
|-----------|------|
| `secret.get` | シークレット値が取得された |
| `secret.set` | シークレットが作成または更新された |
| `secret.delete` | シークレットが削除された |
| `secret.list` | シークレット一覧が表示された |
| `auth.unlock` | Vault がアンロックされた |
| `auth.lock` | Vault がロックされた |
| `vault.init` | Vault が初期化された |

### ソース別

Vault へのアクセス方法を確認:

| ソース | 説明 |
|--------|------|
| CLI | コマンドラインインターフェース |
| MCP | AI ツール連携 |
| Desktop | デスクトップアプリケーション |

異なるアクセス方法を区別するのに役立ちます。

### シークレットキー別

特定のシークレットのアクティビティを検索:

1. キー名（または部分一致）を入力
2. **適用**をクリック

特定のシークレットに誰がアクセスしたかを調査するのに便利です。

### 日付範囲別

特定の期間にフィルタリング:

1. **開始日**を設定（範囲の開始）
2. **終了日**を設定（範囲の終了）
3. **適用**をクリック

コンプライアンス監査やインシデント調査に役立ちます。

### フィルターをクリア

すべてのフィルターを削除して全履歴を表示:

1. **クリア**をクリック
2. すべてのフィルターがデフォルトにリセット

## チェーン検証

### チェーン検証とは？

各監査ログエントリは HMAC-SHA256 を使用して前のエントリに暗号的にリンクされています。これにより改ざん検出可能なチェーンが作成されます:

- どのエントリを変更してもチェーンが壊れる
- エントリを削除するとチェーンが壊れる
- 順序を変更するとチェーンが壊れる

### チェーンを検証

1. **チェーンを検証**ボタンをクリック
2. 検証が完了するまで待つ
3. ステータスインジケーターを確認

### 検証結果

| ステータス | アイコン | 意味 |
|-----------|---------|------|
| 検証済み | 緑のチェックマーク | チェーンは無傷、改ざんは検出されず |
| 無効 | 赤の X | チェーンが壊れている、改ざんの可能性 |
| 確認中 | グレーのスピナー | 検証進行中 |

:::warning
チェーン検証が失敗した場合、監査ログが改ざんされている可能性があります。これは直ちに調査すべき深刻なセキュリティ上の懸念です。
:::

## 詳細の表示

### 詳細モーダルを開く

任意のログエントリをクリックして詳細を表示:

- **タイムスタンプ** - 完全な日時
- **アクション** - 実行された操作
- **ソース** - アクセス方法
- **キー** - シークレットキー（該当する場合）
- **ステータス** - 成功または失敗
- **エラー** - エラーメッセージ（失敗した場合）

### 詳細モーダルを閉じる

- モーダルの外側をクリック
- X ボタンをクリック
- `Escape` を押す

## ログのエクスポート

### CSV へエクスポート

スプレッドシート分析用:

1. 必要なフィルターを適用
2. **CSV** ボタンをクリック
3. ファイルが自動的にダウンロード

**CSV 形式:**
```csv
Timestamp,Action,Source,Key,Status,Error
2025-01-15T10:30:00Z,secret.get,cli,API_KEY,Success,
2025-01-15T10:25:00Z,secret.set,desktop,DB_PASSWORD,Success,
```

### JSON へエクスポート

プログラムによる処理用:

1. 必要なフィルターを適用
2. **JSON** ボタンをクリック
3. ファイルが自動的にダウンロード

**JSON 形式:**
```json
[
  {
    "timestamp": "2025-01-15T10:30:00Z",
    "action": "secret.get",
    "source": "cli",
    "key": "API_KEY",
    "success": true,
    "error": ""
  }
]
```

### エクスポートのヒント

- フィルターはエクスポートに適用される（必要なものだけエクスポート）
- 大きなエクスポートには時間がかかる場合がある
- ファイル名は `audit-logs.csv` または `audit-logs.json`

## ページネーション

### ページのナビゲート

大きな監査履歴の場合:

- **Prev** - 前のページへ
- **Next** - 次のページへ
- ページインジケーターで現在位置を表示

各ページには20エントリが表示されます。

### ページ情報

フッターには以下が表示されます:
- 現在の範囲（例: 「1-20 / 150」）
- ページ番号（例: 「ページ 1 / 8」）

## ユースケース

### セキュリティインシデント調査

潜在的な侵害を調査する場合:

1. インシデントの**日付範囲**でフィルタリング
2. 異常な**ソース**パターンを確認
3. 失敗した **auth.unlock** 試行をチェック
4. 証拠を JSON でエクスポート

### コンプライアンス監査

規制コンプライアンス用:

1. 監査期間に**日付範囲**を設定
2. 完全なログを CSV でエクスポート
3. コンプライアンスチームに提供
4. チェーン検証状態を文書化

### アクセスレビュー

誰が何にアクセスしたかを確認:

1. 特定の**キー**でフィルタリング
2. **ソース**別のすべてのアクセスを確認
3. パターンや異常を特定
4. 結果を文書化

### 失敗のトラブルシューティング

操作が失敗した場合:

1. **ステータス**（失敗）でフィルタリング
2. 詳細ビューで**エラー**メッセージを確認
3. **ソース**と**アクション**を特定
4. 根本原因に対処

## アクションの理解

### 認証アクション

| アクション | トリガー |
|-----------|---------|
| `vault.init` | 初回 Vault 作成 |
| `auth.unlock` | マスターパスワード入力 |
| `auth.lock` | 手動ロックまたは自動ロック |

### シークレットアクション

| アクション | トリガー |
|-----------|---------|
| `secret.list` | シークレット一覧の表示 |
| `secret.get` | シークレット値の表示 |
| `secret.set` | 作成または更新 |
| `secret.delete` | シークレットの削除 |

### ソースの識別

| ソース | 使用時 |
|--------|--------|
| `cli` | secretctl コマンドラインツール |
| `mcp` | AI コーディングアシスタント連携 |
| `ui` | デスクトップアプリケーション |

## 統計

### 統計の理解

ヘッダーには集計された統計が表示されます:

- **合計**: 記録されたすべてのアクション
- **成功**: 正常に完了したアクション
- **失敗**: 失敗したアクション

### 数値の解釈

**失敗数が多い**場合:
- 不正なパスワード試行
- 権限の問題
- システムエラー

**予期しないソース**がある場合:
- 不正アクセスの試み
- 設定ミスの連携

## ベストプラクティス

### 定期的なレビュー

定期的な監査レビューをスケジュール:
- 週次: 異常のクイックスキャン
- 月次: 完全なエクスポートと分析
- 四半期: コンプライアンス文書化

### 定期的なチェーン検証

チェーン検証を実行:
- 疑わしいアクティビティの後
- コンプライアンス監査の前
- システムメンテナンスの後

### バックアップ用エクスポート

オフラインコピーを保持:
- 月次アーカイブをエクスポート
- 安全な場所に保存
- 検証結果を含める

### ソースの監視

アクセスパターンを追跡:
- 予期しない MCP アクセスは AI ツールの設定ミスを示す可能性
- 営業時間外の CLI アクセスは調査が必要な可能性
- 異常なパターンからのデスクトップアクセスは確認の価値あり

## トラブルシューティング

### ログが表示されない

**考えられる原因:**
- フィルターが厳しすぎる - **クリア**をクリック
- 履歴のない新しい Vault
- 結果の最後のページにいる

### チェーン検証が失敗

**即座のアクション:**
1. 監査ログを信頼しない
2. 潜在的な改ざんを調査
3. 破損をチェック
4. セキュリティチームに連絡

### エクスポートが機能しない

**以下を試す:**
1. ブラウザのダウンロード設定を確認
2. フィルター範囲を縮小
3. 別のエクスポート形式を試す
4. 利用可能なディスク容量を確認

### パフォーマンスが遅い

**大きなログの場合:**
1. より具体的なフィルターを使用
2. 日付範囲を狭める
3. ページネーションの読み込みを待つ
4. エクスポートしてオフラインで分析を検討

## 次のステップ

- [シークレットの管理](/docs/guides/desktop/managing-secrets) - シークレット操作ガイド
- [デスクトップアプリ概要](/docs/guides/desktop/) - 完全な機能ガイド
- [設定リファレンス](/docs/reference/configuration) - 監査ログ保持設定
